apply plugin: 'com.android.application'
apply plugin: 'kotlin-android'
apply plugin: 'kotlin-kapt'
apply plugin: 'com.google.gms.google-services'
apply plugin: 'io.fabric'

android {
    signingConfigs {
        release {
            keyAlias gradle.ext.storeKeyAlias
            keyPassword gradle.ext.storeKeyAliasPassword
            storeFile file(gradle.ext.storeKeyFile)
            storePassword gradle.ext.storeKeyPassword
        }
    }
    compileSdkVersion androidConfig.compileSdkVersion
    defaultConfig {
        applicationId 'net.thebix.debts'
        minSdkVersion androidConfig.minSdkVersion
        targetSdkVersion androidConfig.targetSdkVersion
        versionCode 15
        versionName "2.0.0.$versionCode"

        javaCompileOptions {
            annotationProcessorOptions {
                arguments = ["room.schemaLocation": "$projectDir/schemas".toString()]
            }
        }
        defaultConfig {
            manifestPlaceholders = [
                    crashlytics: gradle.ext.fabricApiKey
            ]
        }
    }

    buildTypes {
        debug {
            applicationIdSuffix ".debug"
        }
        release {
            shrinkResources true
            minifyEnabled true
            zipAlignEnabled true
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
            signingConfig signingConfigs.release
        }
    }

    // used by Room, to test migrations
    sourceSets {
        androidTest.assets.srcDirs +=
                files("$projectDir/schemas".toString())
    }

    // TODO: enable lint local checks and remove this
    lintOptions {
        abortOnError false
    }
}

dependencies {
    implementation libs.androidxAppCompat
    implementation libs.androidxConstraintLayout
    implementation libs.androidxCore
    implementation libs.androidxDesign
    kapt libs.androidxLifecycleCompiler
    implementation libs.androidxPreference
    implementation libs.crashlytics
    implementation libs.firebaseCore
    implementation libs.glide
    kapt libs.glideCompiler
    implementation libs.koin
    implementation libs.koinScope
    implementation libs.koinViewModel
    implementation libs.koptional
    implementation libs.kotlin
    debugImplementation libs.leakCanary
    implementation libs.room
    kapt libs.roomCompiler
    implementation libs.roomRxJava
    testImplementation libs.roomTesting
    implementation libs.rxAndroid
    implementation libs.rxBinding
    implementation libs.rxJava2
    implementation libs.timber
}
